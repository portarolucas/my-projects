(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f721d834"],{"170d":function(e,s,t){"use strict";t.r(s);var a=t("7a23"),n=void 0,i=Object(a["I"])("data-v-26c44e04");Object(a["t"])("data-v-26c44e04");var o={class:"main-content"},c=Object(a["f"])('<div class="backgrounds-container" data-v-26c44e04><div class="bg-1-container" data-v-26c44e04><div class="bg" data-v-26c44e04></div></div><div class="bg-2-container" data-v-26c44e04><div class="bg" data-v-26c44e04></div></div><div class="bg-3-container" data-v-26c44e04><div class="bg" data-v-26c44e04></div></div><div class="bg-4-container" data-v-26c44e04><div class="bg" data-v-26c44e04></div></div><div class="bg-5-container" data-v-26c44e04><div class="bg" data-v-26c44e04></div></div></div>',1),r={class:"panel"},d={class:"messages"},u={class:"footer-conversation"},l=Object(a["h"])("button",null,"Envoyer",-1);Object(a["r"])();var v=i((function(e,s,t,i,v,g){return Object(a["q"])(),Object(a["d"])("div",o,[c,Object(a["h"])("div",null,[Object(a["h"])("h1",null,[Object(a["h"])("u",null,Object(a["A"])(n.title),1)]),Object(a["h"])("h3",null,"Voici les derniers messages (total: "+Object(a["A"])(v.messages_count)+")",1),Object(a["h"])("div",r,[Object(a["h"])("div",d,[(Object(a["q"])(!0),Object(a["d"])(a["a"],null,Object(a["w"])(v.messages,(function(e){return Object(a["q"])(),Object(a["d"])("div",{class:["message",{"self-message":0==e.message.user_isAdmin}]},Object(a["A"])(e.message.message),3)})),256))]),Object(a["h"])("div",u,[Object(a["h"])("form",{onSubmit:s[2]||(s[2]=Object(a["H"])((function(){return g.createMessage&&g.createMessage.apply(g,arguments)}),["prevent"])),class:"send-message",style:{width:"100%"}},[Object(a["G"])(Object(a["h"])("input",{"onUpdate:modelValue":s[1]||(s[1]=function(e){return v.newMessage=e}),type:"text",placeholder:"Envoyer un message"},null,512),[[a["D"],v.newMessage]]),l],32)])])])])})),g=(t("1157"),{name:"Conversation",data:function(){return{messages:[],title:"",uuid:null,messages_count:"",newMessage:"",messagesRefresh:null}},watch:{messages:function(){this.updated()}},methods:{init:function(){this.loadData(),this.setConversationRead()},refreshMessage:function(){this.loadData()},updated:function(){window.scrollTo(0,document.body.scrollHeight)},loadData:function(){var e=this;api.get("/conversations/"+this.uuid+"/messages?size=20").then((function(s){e.messages=s.data.messages.reverse(),e.messages_count=s.data.count})).catch((function(s){403===s.response.status?(console.log("interdit"),e.$router.push("/conversations")):alert(s.response.data.message_status?s.response.data.message_status:"Votre action n'a pû aboutir, une erreur inconnue s'est produite.")})),api.get("/conversations/"+this.uuid).then((function(s){e.title=s.data.conversation.title,e.admin=s.data.conversation.admin_info})).catch((function(s){403===s.response.status?(console.log("interdit"),e.$router.push("/conversations")):alert(s.response.data.message_status?s.response.data.message_status:"Votre action n'a pû aboutir, une erreur inconnue s'est produite.")}))},createMessage:function(){var e=this;""!=this.newMessage?api.post("/conversations/"+this.uuid+"/messages",{message:this.newMessage}).then((function(s){alert(s.data.message_status),e.loadData(),e.newMessage=""})):alert("Vous devez entrer un message et ensuite l'envoyer...")},setConversationRead:function(){var e=[];e.push(this.uuid),api.post("/account/conversations",{conversations:e}).then((function(e){window.mitt.emit("update_menu_conversation")}))}},updated:function(){window.scrollTo(0,document.body.scrollHeight)},created:function(){var e=this;this.uuid=this.$route.params.uuid,this.messagesRefresh=setInterval((function(){console.log("INTERVAL (conversation)"),e.refreshMessage()}),1e3)},mounted:function(){this.init()},beforeUnmount:function(){console.log("INTERVAL (conversation) : SUPPRIMÉ"),clearInterval(this.messagesRefresh)}});t("925c");g.render=v,g.__scopeId="data-v-26c44e04";s["default"]=g},7313:function(e,s,t){},"925c":function(e,s,t){"use strict";t("7313")}}]);
//# sourceMappingURL=chunk-f721d834.02a6d7c7.js.map